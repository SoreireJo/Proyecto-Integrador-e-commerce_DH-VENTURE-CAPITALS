<!DOCTYPE html>
<html lang="en">
<!-- Head -->
<%- include('../partials/head.ejs', {title: 'Productos por categoría '}) %>
<!-- /Head -->

<body>
    <!-- Header -->
    <%- include('../partials/header.ejs') %>
    <!-- /Header -->

    <!-- Main (Productos) -->
    <main class="main-index">
            <div class="linea"></div>
            <% if (products.length > 0) {%>
            <h3 class="titulo-main-index"><%=products[0].categorias[0].nombre%></h3>
            <%}else{%><h2><%=id%></h2>
            <div class="bar-ccb" id="cc-bar"></div>
            <div class="linea"></div>
            <div class="msg bad-search">
                <img src="/desing/iconos/sad-icon.png" alt="carita triste" />
                <h4>Nos quedamos sin productos en esta categoría</h4>
            </div> <%}%>
            <div class="bar-ccb" id="cc-bar"></div>
            <div class="linea"></div>
            <!-- Sección: Productos por categoría -->
            <section class="sec-products">

                <div class="products">

                    <% if (product.length > 0) {
                        product.forEach(product => {
                            if (product.categorias[0].categoriaId == id) {
                                
			        	let finalPrice = (product.precio * ((100 - product.descuento) / 100)).toFixed(0);
                    %>

                        <!-- Card -->
                        <article class="last-tec">
                            <a href="/products/productDetail/<%= product.productoId %> %>">
                                
                                <div class="linea-blanca"></div>
                                <div class="main-card-img">
                                    <img src="/images/products/<%= product.imagen %>" alt="Imagen del producto" class="product_img">
                                </div>
                                <div class="linea-blanca"></div>
                            </a>
                            <div class="bar-ggr" id="gg-bar"></div>

                            <div class="main-article">
                                <div class="min-row">
                                    <button class="buttAgregar2">
                                        <i class="fa-solid fa-cart-plus" id="crtct" style="font-size: 1.2em;"></i>
                                    </button>
                                    <p class="discount"><%= product.descuento%>% off</p>
                                </div>
                                <p class="price">$<%= toThousand(finalPrice) %></p>
                                <h4 class="description2"><%= product.nombre %></h4>
                            </div>
                        </article>
                        
                        <% }}); %>
                        <%  let u = 4 - (products.length % 4);
                            for(let i = 0; i < u && u != 4 ; i++) {
                        %>
                            <!-- GhostCard (Completando la fila de 4)-->
                            <div class="bocadito-ghostcard"><img src="/desing/iconos/ghostcard.png"/></div>
                        <% } %>

                    <% } else { %>   
                        <div class="msg bad-search">
                            <img src="/desing/iconos/sad-icon.png" alt="carita triste" />
                            <h4>Nos quedamos sin productos en esta categoría</h4>
                        </div> 
                    <% } %>
                </div>
            </section>
    </main>

    <!-- Footer -->
    <%- include('../partials/footer.ejs') %>
    <!-- /Footer -->
</body>
</html>